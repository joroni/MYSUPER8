<template>
    <div class="page" data-name="catalogb">
        <div class="navbar">
            <div class="navbar-inner sliding">
                <div class="title">Customers</div>
            </div>
        </div>
        <div class="fab fab-right-bottom">
            <a href="#" class="fill popup-open" data-popup="#my-popup">
                <i class="icon f7-icons">add</i>
            </a>
        </div>
        <div class="page-content">
            <div class="list links-list">
                <ul id="customerList"></ul>
              <!--  <ul id="li-integrantes">
                    {{#each productbs}}
					<li>
						<a href="/productb/{{id}}/">{{title}} {{fname}}</a>
					</li>
					{{/each}}
                </ul>-->
            </div>

        </div>
        <!-- Popup -->
        <div class="popup" id="my-popup">
            <div class="view">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-inner">
                            <div class="title"></div>
                            <div class="right">
                                <a href="#" class="link popup-close">Close</a>
                            </div>
                        </div>
                    </div>
                    <div class="page-content">


                        <div class="block-title"></div>
                        <div class="list no-hairlines-md">
                            <ul>
                                <li>
                                    <input type="hidden" id="txt-id" name="fname" />
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">First Name</div>
                                            <div class="item-input-wrap">
                                                <input type="text" id="fname" name="fname" />
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Last Name</div>
                                            <div class="item-input-wrap">
                                                <input type="text" id="lname" name="lname" />
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Phone</div>
                                            <div class="item-input-wrap">
                                                <input type="number" id="phone" name="phone" />
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Birth date</div>
                                            <div class="item-input-wrap">
                                                <input type="date" id="birthdate" name="birthdate" placeholder="Birth day"
                                                    value="2014-04-30" />
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Email</div>
                                            <div class="item-input-wrap">
                                                <input type="email" id="email" name="email" />
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Street Name</div>
                                            <div class="item-input-wrap">
                                                <input type="text" id="add_street" name="add_street" />
                                            </div>
                                        </div>
                                    </div>
                                </li>

                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Unit, Building, Floor No.</div>
                                            <div class="item-input-wrap">
                                                <input type="text" id="add_unit" name="add_unit" />
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">City</div>
                                            <div class="item-input-wrap">
                                                <select id="add_city" name="add_city">
                                                    <option>Manila</option>
                                                    <option>Quezon City</option>
                                                    <option>Makati</option>
                                                    <option>Pasig</option>
                                                    <option>Mandaluyong</option>
                                                    <option>Pasay</option>
                                                    <option>Taguig</option>
                                                    <option>Las Pi√±as</option>


                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </li>

                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Area</div>
                                            <div class="item-input-wrap">
                                                <input type="text" id="add_area" name="add_area" />
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Zip Code</div>
                                            <div class="item-input-wrap">
                                                <input type="text" id="add_zip" name="add_zip" />
                                            </div>
                                        </div>
                                    </div>
                                </li>

                                <li>
                                    <div class="item-content item-input">
                                        <div class="item-inner">
                                            <div class="item-title item-label">Landmark</div>
                                            <div class="item-input-wrap">
                                                <input type="text" id="add_landmark" name="add_landmark" />
                                                <input type="hidden" id="timestamp" name="timestamp" />
                                            </div>
                                        </div>
                                    </div>
                                </li>

                            </ul>
                        </div>
                        <div id="btnNewContainer" class="block">
                                <a href-="#" id="submit" type="submit" class="button form-to-data button button-raised button-fill">Submit</a>
                        </div>
                        <br>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
<!--<script>
    var db = openDatabase('super8', '1.0', 'Customers and Order processing', 100 * 1024);

$(document).ready(function () {

    console.info("Initialize...");

    init();

    memberList();

    selectCustomertoShop();
    console.info("Carga Complete...");

    ////////////////////////////////////////////////////////////////////
    ////////////////////////////Funciones jquery///////////////////////
    ////////////////////////////////////////////////////////////////////
    $('#submit').click(function () {
        var txtId = $('#txt-id');
        var txtFname = $('#fname');
        var txtLname = $('#lname');
        var txtPhone = $('#phone');
        var txtEmail = $('#email');

        var input = $('input');

        if (txtFname.val() === '' || txtLname.val() === '' || txtPhone.val() === '' || txtEmail.val() ===
            '') {
            alert("All fields are Required...");
            return;
        }

        var integrante = Object();

        integrante.fname = txtFname.val();
        integrante.lname = txtLname.val();
        integrante.phone = txtPhone.val();
        integrante.email = txtEmail.val();



        if (txtId.val() === '') { //Lo guarda
            integrante.id = new Date().getTime();
            saveMember(integrante);
        } else { //Lo actualiza
            integrante.id = parseInt(txtId.val());
            updateMember(integrante);
        }

        memberList();

        txtFname.val(null);
        txtLname.val(null);
        txtPhone.val(null);
        txtEmail.val(null);
        txtId.val(null);
    });



    /*  $('#li-integrantes').on("click", ".btn-user-info", function () {
          var idMember = $(this).data("id");
          selectMember(idMember);
          $("label").addClass("active");
          //$("#modal-Title").html("View Customer");

      });*/


    /*  $('#li-integrantes').on("click", ".btn-editar", function () {
          var idMember = $(this).data("id");
          selectMember(idMember);
          $("label").addClass("active");
          $("#modal-Title").html("Edit Customer");

      });

      $('#li-integrantes').on("click", ".btn-eliminar", function () {
          var idMember = $(this).data("id");
          removeMember(idMember);
          memberList();
      });*/

});

////////////////////////////////////////////////////////////////////
///////////////////////funciones para el CRUd///////////////////////
////////////////////////////////////////////////////////////////////
function init() {
    db.transaction(function (tx) {
        tx.executeSql('create table if not exists CUSTOMERS(ID, FNAMES, LNAMES,PHONE, EMAIL)');
        tx.executeSql('create table if not exists PURCHASEORDER(ID, FNAMES, LNAMES,PHONE, EMAIL)');
    }, error, exito);
}

function memberList() {
    db.readTransaction(function (t) {
        t.executeSql('SELECT ID, FNAMES, LNAMES, PHONE, EMAIL FROM CUSTOMERS', [], function (t, rs) {
            if (rs.rows.length > 0) {
                var lisHtml = "";

                for (var i = 0; i < rs.rows.length; i++) {
                    var integrante = rs.rows.item(i);
                    var id = integrante.ID;

                    lisHtml += '<li><a href="/productb/'+integrante.ID +'">'+ integrante.FNAMES + ' ' + integrante.LNAMES + '</a></li>'

                }
                
               /* localStorage.setItem("listHTML", lisHtml);

                var permdata = localStorage.getItem("listHTML");
                console.log(permdata);*/
                
                $('#li-integrantes').html(lisHtml);
                

                /* $(function () {
                     $('.icon-btn').on('click', function () {
                         $('.showData').toggle();
                     });
                 });*/


                $('[data-toggle="class"]').click(function () {
                    var $target = $($(this).data('target'));
                    var classes = $(this).data('classes');

                    $target.toggleClass(classes);
                    return false;
                });




                $("#btnNew").click(function () {
                    console.log("reset fields");
                    $('#dynamic-form')[0].reset();
                    $('#modalBody').html("")
                    $('#txt-id').val("");
                    $("#modal-Title").html("Add Customer");

                })



            }

        }, error);
    });
}



function selectCustomertoShop() {
    db.readTransaction(function (t) {
        t.executeSql('SELECT ID, FNAMES, LNAMES, PHONE, EMAIL FROM CUSTOMERS', [], function (t, rs) {
            if (rs.rows.length > 0) {
                var lisHtml = '';

                for (var i = 0; i < rs.rows.length; i++) {
                    var integrante = rs.rows.item(i);
                    var id = integrante.ID;



                    /*    lisHtml += '<div class="list-group-item customer-list list-group-item-action">'+
                                '<div class="media"><i class="material-icons"></i>' +
                                    '<a href="#" onclick="viewidMember('+ id +')"><img src="img/user.svg" class="mr-3 btn-user-info img-circle" width="48" alt=' + integrante.FNAMES + ' ' + integrante.LNAMES +" /></a>" +
                                    '<div class="media-body"><h5 class="mt-0 customer-name">' + integrante.FNAMES + ' ' + integrante.LNAMES + '</h5><p> ' + integrante.PHONE + '</p></div>'+
                                '</div>'+
                            '</div>';
*/

                    lisHtml += '<li><a href="#">' + integrante.FNAMES + ' ' + integrante.LNAMES + '</li>'

                }


                $('#li-integrantes').append(lisHtml);



                $('[data-toggle="class"]').click(function () {
                    var $target = $($(this).data('target'));
                    var classes = $(this).data('classes');

                    $target.toggleClass(classes);
                    return false;
                });




                $("#btnNew").click(function () {
                    console.log("reset fields");
                    $('#dynamic-form')[0].reset();
                    $('#modalBody').html("")
                    $('#txt-id').val("");
                    $("#modal-Title").html("Add Customer");

                })



            }

        }, error);
    });
}




function saveMember(integrante) {
    db.transaction(function (tx) {
        tx.executeSql('INSERT INTO CUSTOMERS(ID, FNAMES, LNAMES, PHONE, EMAIL) VALUES(?, ?, ?,?,?)', [
            integrante.id, integrante.fname, integrante.lname, integrante.phone, integrante.email
        ]);
    }, error, function () {
        alert("Item Saved.");
        // $(".close, .pop-up").trigger();
        $$(".popup-backdrop").removeClass("backdrop-in");

    });
}



function selectMember(idMember) {
    // localStorage.setItem("customer-name",idMember);
    db.readTransaction(function (t) {
        t.executeSql('SELECT ID, FNAMES, LNAMES , PHONE, EMAIL FROM CUSTOMERS WHERE ID = ?', [idMember],
            function (t, rs) {
                if (rs.rows.length > 0) {
                    var integrante = new Object();
                    integrante.fname = rs.rows.item(0).FNAMES;
                    integrante.lname = rs.rows.item(0).LNAMES;
                    integrante.phone = rs.rows.item(0).PHONE;
                    integrante.email = rs.rows.item(0).EMAIL;
                    $('#txt-id').val(rs.rows.item(0).ID);
                    $('#fname').val(rs.rows.item(0).FNAMES);
                    $('#lname').val(rs.rows.item(0).LNAMES);
                    $('#phone').val(rs.rows.item(0).PHONE);
                    $('#email').val(rs.rows.item(0).EMAIL);
                }
            }, error);
    });
}



function viewidMember(idMember) {
    localStorage.setItem("idMember", idMember);
    console.log(idMember);
    // viewidMember(idMembre);
    db.readTransaction(function (t) {
        t.executeSql('SELECT ID, FNAMES, LNAMES , PHONE, EMAIL FROM CUSTOMERS WHERE ID = ?', [idMember],
            function (t, rs) {
                if (rs.rows.length > 0) {
                    var integrante = new Object();
                    integrante.fname = rs.rows.item(0).FNAMES;
                    integrante.lname = rs.rows.item(0).LNAMES;
                    integrante.phone = rs.rows.item(0).PHONE;
                    integrante.email = rs.rows.item(0).EMAIL;
                    $('#txt-id').val(rs.rows.item(0).ID);
                    $('#fname').html(rs.rows.item(0).FNAMES);
                    $('#lname').html(rs.rows.item(0).LNAMES);
                    $('#phone').html(rs.rows.item(0).PHONE);
                    $('#email').html(rs.rows.item(0).EMAIL);
                    //console.log($(this).attr([id]));
                }
            }, error);
    });
}

function updateMember(integrante) {
    db.transaction(function (tx) {
        tx.executeSql('UPDATE CUSTOMERS SET FNAMES = ?, LNAMES = ?, PHONE = ?, EMAIL = ?, WHERE ID = ?', [
            integrante.phone, integrante.fname, integrante.lname, integrante.id
        ]);
    }, error, function () {
        alert("The member has been updated successfully");
    });
}

function removeMember(idMember) {


    var retVal = confirm("This will delete the selected record? Do you want to continue ?");
    if (retVal == true) {
        db.transaction(function (tx) {
            tx.executeSql('DELETE FROM CUSTOMERS WHERE ID = ?', [idMember]);
        }, error, function () {
            alert("The member has been removed successfully");
        })
        return true;
    } else {

        return false;
    }



    /*  db.transaction(function (tx) {
          tx.executeSql('DELETE FROM CUSTOMERS WHERE ID = ?', [idMember]);
      }, error, function () {
          alert("The member has been rem successfully");
      });*/
}

function savePO(integrante) {
    db.transaction(function (tx) {
        tx.executeSql('INSERT INTO CUSTOMERS(ID, FNAMES, LNAMES, PHONE, EMAIL) VALUES(?, ?, ?,?,?)', [
            integrante.id, integrante.fname, integrante.lname, integrante.phone, integrante.email
        ]);
    }, error, function () {
        alert("Item Saved.");
        $(".close").trigger();
    });
}


////////////////////////////////////////////////////////////////////
////////////////////////Funciones de logueo////////////////////
////////////////////////////////////////////////////////////////////
var error = function (err) {
    console.error(err);
};

var exito = function () {
    console.info("Table created...");
};



</script>-->
<!--<script>

    
    return {
        data: function () {
            return {
                productbs: this.$root.productbs,
            };
        }
    };
</script>
-->